<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Select Voice for TTS Example</title>
</head>

<body>
    <textarea id="textArea" rows="4" cols="50" placeholder="Type something..."></textarea>

    <ul id="voiceList"></ul>
    <button onclick="speakText()">Speak</button>

    <script>
        let voices = [];
        const voiceList = document.getElementById('voiceList');
        let selectedVoice = null;

        // This function populates the voice list
        function populateVoiceList() {
            voices = speechSynthesis.getVoices();
            voiceList.innerHTML = ''; // Clear current list items

            voices.forEach((voice, i) => {
                const li = document.createElement('li');
                li.innerHTML = `${voice.name} (${voice.lang})`;
                li.style.cursor = "pointer";
                
                // Highlight the selected voice when clicked
                li.addEventListener('click', function() {
                    if (selectedVoice) {
                        selectedVoice.style.background = 'none';
                    }
                    li.style.background = '#ccc';
                    selectedVoice = li;
                });

                li.dataset.voiceIndex = i;
                voiceList.appendChild(li);
            });
        }

        // For some browsers, the list of voices is loaded asynchronously after page load
        speechSynthesis.onvoiceschanged = populateVoiceList;
        populateVoiceList();

        function speakText() {
            const text = document.getElementById('textArea').value;

            const utterance = new SpeechSynthesisUtterance(text);
            
            if (selectedVoice) {
                const voiceIndex = selectedVoice.dataset.voiceIndex;
                if (voiceIndex in voices) {
                    utterance.voice = voices[voiceIndex];
                }
            }

            speechSynthesis.speak(utterance);
        }
    </script>
</body>

</html>
